<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Killer Pool</title>

<style>
:root{
  --bg1:#6ff0c0;
  --bg2:#29b98b;
  --panel:rgba(255,255,255,.18);
  --border:rgba(255,255,255,.28);
}

*{box-sizing:border-box;}

body{
  margin:0;
  min-height:100vh;
  display:flex;
  justify-content:center;
  background:linear-gradient(180deg,var(--bg1),var(--bg2));
  font-family:system-ui,Segoe UI,Roboto,Arial;
  color:#fff;
  padding:20px 10px;
}

.frame{width:min(700px,100%);text-align:center;position:relative;}

h1{
  font-weight:900;
  margin:10px 0 14px;
  text-shadow:0 8px 25px rgba(0,0,0,.3);
}

.rail{
  background:var(--panel);
  border:1px solid var(--border);
  border-radius:18px;
  padding:14px;
  box-shadow:0 12px 30px rgba(0,0,0,.25);
}

input,button{
  width:92%;
  max-width:340px;
  padding:12px;
  margin:7px 0;
  border-radius:14px;
  border:none;
  font-size:18px;
}

input{
  background:rgba(255,255,255,.25);
  color:#fff;
  text-align:center;
}

button{font-weight:800;cursor:pointer;}

.secondary{background:#3498db;color:#fff;}
.play{background:#2ecc71;color:#111;}
.miss{background:#e67e22;color:#111;}
.pot{background:#1abc9c;color:#111;}
.black{background:#000;color:#fff;}
.whiteball{background:#fff;color:#111;}

.topButtons{
  position:absolute;
  top:10px;
  right:10px;
  display:flex;
  gap:6px;
}

.smallBtn{
  padding:6px 10px;
  font-size:14px;
  border-radius:999px;
  width:auto;
  max-width:none;
  background:rgba(0,0,0,.35);
  color:#fff;
}

.stage{margin-top:10px;}

.nameBig{
  font-size:40px;
  font-weight:900;
  margin:10px 0;
}

.cardBox{
  background:#fff;
  color:#111;
  border-radius:18px;
  padding:20px;
  font-size:80px;
  font-weight:900;
  width:220px;
  margin:10px auto;
  box-shadow:0 14px 35px rgba(0,0,0,.25);
}

.btnRow{
  display:flex;
  flex-wrap:wrap;
  gap:10px;
  justify-content:center;
}

.btnRow button{width:45%;}

.piles{
  display:grid;
  grid-template-columns:1fr;
  gap:10px;
  margin-top:15px;
}

@media(min-width:600px){
  .piles{grid-template-columns:1fr 1fr 1fr;}
}

.pile{
  background:rgba(255,255,255,.15);
  border:1px solid rgba(255,255,255,.25);
  border-radius:16px;
  padding:12px;
}

.pile h3{
  margin:0 0 6px;
  font-size:14px;
  text-transform:uppercase;
}

.count{
  font-size:28px;
  font-weight:900;
}

/* Dramatic reshuffle */
#reshuffleOverlay{
  display:none;
  position:fixed;
  inset:0;
  background:radial-gradient(circle at center, rgba(255,255,255,.2), rgba(0,0,0,.8));
  z-index:5000;
  justify-content:center;
  align-items:center;
  flex-direction:column;
}

#reshuffleText{
  font-size:70px;
  font-weight:1000;
  text-shadow:0 20px 60px rgba(0,0,0,.6);
  animation:pop 1.5s ease forwards;
}

.cardStack{
  width:120px;
  height:160px;
  background:#fff;
  border-radius:16px;
  margin-top:20px;
  box-shadow:0 15px 40px rgba(0,0,0,.6);
  animation:spin 1.5s linear infinite;
}

@keyframes spin{
  from{transform:rotateY(0);}
  to{transform:rotateY(360deg);}
}

@keyframes pop{
  0%{opacity:0;transform:scale(.7);}
  30%{opacity:1;transform:scale(1.1);}
  100%{opacity:0;transform:scale(1.2);}
}

/* Referee overlay */
#refOverlay{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.85);
  z-index:4000;
  color:#fff;
  padding:20px;
  overflow:auto;
}

#refPanel{
  max-width:600px;
  margin:auto;
}

</style>
</head>
<body>

<div class="frame">
<h1>üé± Killer Pool</h1>

<div class="topButtons">
<button class="smallBtn" onclick="toggleRef()">üßë‚Äç‚öñÔ∏è Ref</button>
<button class="smallBtn" onclick="toggleFullscreen()">‚õ∂ Fullscreen</button>
</div>

<div class="rail">

<div id="setup">
<div id="playerList"></div>
<button class="secondary" onclick="addPlayer()">‚ûï Add Player</button>
<button onclick="drawCards()">üé¥ Draw Cards</button>
<div id="results"></div>
<button id="startBtn" class="play" onclick="startGame()" style="display:none;">‚ñ∂Ô∏è Play Game</button>
</div>

<div id="game" class="stage" style="display:none;">
<div class="nameBig" id="currentName"></div>
<div class="cardBox" id="cardBox">A</div>

<div class="btnRow">
<button class="miss" onclick="doAction('miss')">‚ùå Miss</button>
<button class="pot" onclick="doAction('pot')">üéØ Pot</button>
<button class="black" onclick="doAction('black')">‚ö´ Black</button>
<button class="whiteball" onclick="doAction('white')">‚ö™ White</button>
</div>

<div class="piles">
<div class="pile"><h3>Pile 1 ‚Äî In Play</h3><div class="count" id="p1">0</div></div>
<div class="pile"><h3>Pile 2 ‚Äî Banked</h3><div class="count" id="p2">0</div></div>
<div class="pile"><h3>Pile 3 ‚Äî Dead</h3><div class="count" id="p3">0</div></div>
</div>

</div>

</div>
</div>

<!-- Dramatic reshuffle -->
<div id="reshuffleOverlay">
<div id="reshuffleText">RESHUFFLE</div>
<div class="cardStack"></div>
</div>

<!-- Referee -->
<div id="refOverlay" onclick="toggleRef()">
<div id="refPanel" onclick="event.stopPropagation()">
<h2>üßë‚Äç‚öñÔ∏è Referee Mode</h2>
<div id="refContent"></div>
<button onclick="toggleRef()">Close</button>
</div>
</div>

<script>
let players=[];
let activePlayers=[];
let currentIdx=null;

let pile1=0; // in play
let pile2=0; // banked
let pile3=0; // dead

const baseDeck=["A","K","Q","J","10","9","8","7","6","5","4","3","2"];

function addPlayer(){
  const input=document.createElement("input");
  input.placeholder="Player name";
  document.getElementById("playerList").appendChild(input);
}

function drawCards(){
  players=[];
  activePlayers=[];
  pile1=0; pile2=0; pile3=0;

  const names=[...document.querySelectorAll("#playerList input")]
    .map(i=>i.value.trim()).filter(Boolean);

  const deck=[...baseDeck].sort(()=>Math.random()-0.5);

  names.forEach(name=>{
    const card=deck.pop();
    players.push({name,card,lives:3});
    pile1+=3;
  });

  document.getElementById("startBtn").style.display="inline-block";
  updateUI();
}

function startGame(){
  activePlayers=players.map((_,i)=>i);
  document.getElementById("setup").style.display="none";
  document.getElementById("game").style.display="block";
  nextTurn();
}

function nextTurn(){
  if(activePlayers.length===1){
    const w=players[activePlayers[0]];
    document.getElementById("currentName").textContent=`üèÜ ${w.name} WINS`;
    document.getElementById("cardBox").textContent=w.card;
    return;
  }
  currentIdx=activePlayers[Math.floor(Math.random()*activePlayers.length)];
  const p=players[currentIdx];
  document.getElementById("currentName").textContent=p.name;
  document.getElementById("cardBox").textContent=p.card;
  updateUI();
}

function reshuffle(){
  if(pile1===0 && pile2>0){
    showReshuffle();
    pile1=pile2;
    pile2=0;
  }
}

function doAction(type){
  const p=players[currentIdx];

  if(type==="pot"||type==="black"){
    reshuffle();
    if(pile1>0){
      pile1--;
      pile2++;
      p.lives++;
    }
    nextTurn();
    return;
  }

  if(type==="miss"||type==="white"){
    if(p.lives>0){
      p.lives--;
      pile1--;
      pile3++;
    }
    if(p.lives<=0){
      activePlayers=activePlayers.filter(i=>i!==currentIdx);
    }
    nextTurn();
  }
}

function updateUI(){
  document.getElementById("p1").textContent=pile1;
  document.getElementById("p2").textContent=pile2;
  document.getElementById("p3").textContent=pile3;
}

function showReshuffle(){
  const o=document.getElementById("reshuffleOverlay");
  o.style.display="flex";
  setTimeout(()=>o.style.display="none",1500);
}

function toggleRef(){
  const r=document.getElementById("refOverlay");
  if(r.style.display==="block"){r.style.display="none";return;}
  let html=`<h3>Piles</h3>
  In Play: ${pile1}<br>
  Banked: ${pile2}<br>
  Dead: ${pile3}<br><br>
  <h3>Players</h3>`;
  players.forEach(p=>{
    html+=`${p.name} ‚Äî ${p.lives} lives<br>`;
  });
  document.getElementById("refContent").innerHTML=html;
  r.style.display="block";
}

function toggleFullscreen(){
  if(!document.fullscreenElement){
    document.documentElement.requestFullscreen();
  }else{
    document.exitFullscreen();
  }
}

addPlayer();
addPlayer();
</script>

</body>
</html>
